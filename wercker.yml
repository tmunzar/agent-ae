box: wercker/php
services:
  - wercker/mysql
build:
  steps:
    - script:
        name: install dependencies
        code: |-
            composer install --no-interaction
    - script:
        name: run migrations
        code: php artisan migrate
    - script:
        name: Serve application
        code: php -S localhost:8000 >> /dev/null &
    - script:
        name: PHPUnit integration tests
        code: phpunit --configuration phpunit.xml
deploy:
  steps:
    - duleorlovic/ftp-stage-deploy@0.0.3:
        destination: ftp://www.jellyfish.com.pk/public_html/agent-ae
        username: jellyfis
        password: $FTP_PASSWORD